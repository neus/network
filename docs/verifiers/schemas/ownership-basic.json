{
  "type": "object",
  "required": [
    "owner"
  ],
  "properties": {
    "content": {
      "type": "string",
      "maxLength": 50000,
      "description": "Content being claimed (max 50KB inline; use contentHash + IPFS for larger)"
    },
    "contentHash": {
      "type": "string",
      "pattern": "^0x[a-fA-F0-9]{64}$",
      "description": "Pre-computed SHA-256 or keccak256 hash (optional if content provided)"
    },
    "owner": {
      "type": "string",
      "pattern": "^0x[a-fA-F0-9]{40}$",
      "description": "Wallet address of the owner (must match request walletAddress)"
    },
    "reference": {
      "type": "object",
      "required": [
        "type"
      ],
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "ipfs",
            "ipfs-hash",
            "url",
            "license-nft",
            "contract",
            "qhash",
            "ethereum-tx",
            "on-chain-tx",
            "tx",
            "file",
            "doc",
            "media",
            "username-claim",
            "other"
          ],
          "description": "Reference type for traceability"
        },
        "id": {
          "type": "string",
          "maxLength": 2048,
          "description": "Reference identifier (CID, URL, tx hash, chainId:address:tokenId, etc.). Required for reference-only proofs (when neither content nor contentHash is provided)."
        },
        "title": {
          "type": "string",
          "maxLength": 200,
          "description": "Optional display title"
        },
        "description": {
          "type": "string",
          "maxLength": 500,
          "description": "Optional description"
        },
        "mime": {
          "type": "string",
          "maxLength": 100,
          "description": "MIME type for file references"
        },
        "name": {
          "type": "string",
          "maxLength": 255,
          "description": "Original filename for file references"
        },
        "size": {
          "type": "integer",
          "description": "File size in bytes"
        }
      }
    },
    "provenance": {
      "type": "object",
      "description": "Optional provenance metadata for content origin",
      "properties": {
        "declaredKind": {
          "type": "string",
          "enum": [
            "human",
            "ai",
            "mixed",
            "unknown"
          ],
          "description": "Content creation type (advisory, not verified)"
        },
        "aiContext": {
          "type": "object",
          "description": "AI generation context (when declaredKind is ai or mixed)",
          "properties": {
            "generatorType": {
              "type": "string",
              "enum": [
                "local",
                "saas",
                "agent"
              ],
              "description": "Type of AI generator"
            },
            "provider": {
              "type": "string",
              "maxLength": 64,
              "description": "AI provider (e.g., openai, anthropic, other)"
            },
            "model": {
              "type": "string",
              "maxLength": 128,
              "description": "Model identifier (opaque string)"
            },
            "runId": {
              "type": "string",
              "maxLength": 128,
              "description": "Optional run identifier (opaque string)"
            }
          }
        }
      }
    }
  },
  "allOf": [
    {
      "if": {
        "not": {
          "anyOf": [
            { "required": ["content"] },
            { "required": ["contentHash"] }
          ]
        }
      },
      "then": {
        "required": ["reference"],
        "properties": {
          "reference": { "required": ["type", "id"] }
        }
      }
    }
  ]
}